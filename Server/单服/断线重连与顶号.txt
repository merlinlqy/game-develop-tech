断线重连与顶号在实现上基本一致，因此一起来讨论。

当玩家断线，特别突然的网络中断，服务器端的TCP连接不一定能做出立即相应（约5分钟）。
另外，服务器可能需要维护玩家“假”在线状态（例如开始中的一场战斗），因此会默认玩家是在线的。


而在服务器认为该玩家在线，但是收到同一个玩家的登录状态，则就是断线重连或者顶号处理。

从服务器处理逻辑上，当收到一个登录请求，并且查询到该玩家是在线的情况下则需要做顶号处理。
对于网关服务器，顶号则可以简单的认为是把旧网关连接断掉，然后把新网关映射到原来的玩家对象上。对于游戏服务器，则是直接修改映射即可。

断线重连（顶号）另外一个要处理的问题是，如何让新的客户端能够代替旧的客户端，因此存在所谓的追赶机制。即把当前战斗状态发送给新的客户端。
而战斗因为处于中期，因此需要恢复战斗数据。
处理方式一般有两种。第一种是把开始战斗到当前的战斗所有封包打包重新发送给客户端，让客户端重新模拟整个战斗阶段（这里就有时序问题）。这种方式的好处就是可以与录像系统同时实行，坏处就是封包过大，客户端也要做特殊处理。
第二种就是每隔一个时间（例如10s），做一个snapshot，重连就把snapshot发送给客户端，然后把snapshot到当前的战斗封包发送给客户端。好处就是数据包较短，坏处就是做不了录像。


而在手游阶段，由于手机网络的不稳定性，随时都会存在断线状态，然后重新连接上。在手机处理上，一般都会把网关服务器与客户端的连接断掉，但是对应的游戏服务器与网关服务器的连接继续保持，达到重新登陆以后不需要做过多的登录流程。
